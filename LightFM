{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 데이터 불러오기"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "import itertools\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import scrapbook as sb\n",
    "import scipy.sparse\n",
    "\n",
    "import lightfm\n",
    "from lightfm import LightFM\n",
    "from lightfm.data import Dataset\n",
    "from lightfm import cross_validation\n",
    "from sklearn.preprocessing import LabelEncoder\n",
    "from sklearn.feature_extraction.text import CountVectorizer\n",
    "from lightfm.cross_validation import random_train_test_split\n",
    "from lightfm.evaluation import precision_at_k as lightfm_prec_at_k, auc_score\n",
    "from keras.models import load_model\n",
    "from scipy.sparse import coo_matrix"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "apply_train = pd.read_csv('./data/Dataset/apply_train.csv')\n",
    "resume = pd.read_csv('./data/Dataset/resume.csv')\n",
    "recruitment = pd.read_csv('./data/Dataset/recruitment.csv')\n",
    "resume_certificate = pd.read_csv('./data/Dataset/resume_certificate.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>reg_date</th>\n",
       "      <th>updated_date</th>\n",
       "      <th>degree</th>\n",
       "      <th>graduate_date</th>\n",
       "      <th>hope_salary</th>\n",
       "      <th>last_salary</th>\n",
       "      <th>text_keyword</th>\n",
       "      <th>job_code_seq1</th>\n",
       "      <th>job_code_seq2</th>\n",
       "      <th>job_code_seq3</th>\n",
       "      <th>career_month</th>\n",
       "      <th>career_job_code</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>8482</td>\n",
       "      <td>8482</td>\n",
       "      <td>8482</td>\n",
       "      <td>8482.000000</td>\n",
       "      <td>8482.000000</td>\n",
       "      <td>8482.000000</td>\n",
       "      <td>8482.000000</td>\n",
       "      <td>8287</td>\n",
       "      <td>8482</td>\n",
       "      <td>500</td>\n",
       "      <td>187</td>\n",
       "      <td>8482.000000</td>\n",
       "      <td>7724</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>8482</td>\n",
       "      <td>2999</td>\n",
       "      <td>366</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5295</td>\n",
       "      <td>9</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>NaN</td>\n",
       "      <td>41</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>U00606</td>\n",
       "      <td>2020-03-09</td>\n",
       "      <td>2020-04-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>매장영업관리</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>영업·판매·TM</td>\n",
       "      <td>영업·판매·TM</td>\n",
       "      <td>NaN</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>1</td>\n",
       "      <td>19</td>\n",
       "      <td>43</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>273</td>\n",
       "      <td>7288</td>\n",
       "      <td>261</td>\n",
       "      <td>73</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5059</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.938222</td>\n",
       "      <td>1819.586065</td>\n",
       "      <td>1395.095496</td>\n",
       "      <td>2505.706201</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>69.408984</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.440764</td>\n",
       "      <td>584.009224</td>\n",
       "      <td>1865.951253</td>\n",
       "      <td>2010.082733</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>63.547948</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>2001.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>2007.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2700.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>53.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>2011.000000</td>\n",
       "      <td>2700.000000</td>\n",
       "      <td>3700.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>108.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>2022.000000</td>\n",
       "      <td>10000.000000</td>\n",
       "      <td>10000.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>432.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       resume_seq    reg_date updated_date       degree  graduate_date  \\\n",
       "count        8482        8482         8482  8482.000000    8482.000000   \n",
       "unique       8482        2999          366          NaN            NaN   \n",
       "top        U00606  2020-03-09   2020-04-08          NaN            NaN   \n",
       "freq            1          19           43          NaN            NaN   \n",
       "mean          NaN         NaN          NaN     3.938222    1819.586065   \n",
       "std           NaN         NaN          NaN     0.440764     584.009224   \n",
       "min           NaN         NaN          NaN     2.000000       0.000000   \n",
       "25%           NaN         NaN          NaN     4.000000    2001.000000   \n",
       "50%           NaN         NaN          NaN     4.000000    2007.000000   \n",
       "75%           NaN         NaN          NaN     4.000000    2011.000000   \n",
       "max           NaN         NaN          NaN     6.000000    2022.000000   \n",
       "\n",
       "         hope_salary   last_salary text_keyword job_code_seq1 job_code_seq2  \\\n",
       "count    8482.000000   8482.000000         8287          8482           500   \n",
       "unique           NaN           NaN         5295             9            11   \n",
       "top              NaN           NaN       매장영업관리   재료·화학·섬유·의복      영업·판매·TM   \n",
       "freq             NaN           NaN          273          7288           261   \n",
       "mean     1395.095496   2505.706201          NaN           NaN           NaN   \n",
       "std      1865.951253   2010.082733          NaN           NaN           NaN   \n",
       "min         0.000000      0.000000          NaN           NaN           NaN   \n",
       "25%         0.000000      0.000000          NaN           NaN           NaN   \n",
       "50%         0.000000   2700.000000          NaN           NaN           NaN   \n",
       "75%      2700.000000   3700.000000          NaN           NaN           NaN   \n",
       "max     10000.000000  10000.000000          NaN           NaN           NaN   \n",
       "\n",
       "       job_code_seq3  career_month career_job_code  \n",
       "count            187   8482.000000            7724  \n",
       "unique            11           NaN              41  \n",
       "top         영업·판매·TM           NaN     섬유;봉제;가방;의류  \n",
       "freq              73           NaN            5059  \n",
       "mean             NaN     69.408984             NaN  \n",
       "std              NaN     63.547948             NaN  \n",
       "min              NaN      0.000000             NaN  \n",
       "25%              NaN     18.000000             NaN  \n",
       "50%              NaN     53.000000             NaN  \n",
       "75%              NaN    108.000000             NaN  \n",
       "max              NaN    432.000000             NaN  "
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "resume.describe(include='all')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>address_seq1</th>\n",
       "      <th>address_seq2</th>\n",
       "      <th>address_seq3</th>\n",
       "      <th>career_end</th>\n",
       "      <th>career_start</th>\n",
       "      <th>check_box_keyword</th>\n",
       "      <th>education</th>\n",
       "      <th>major_task</th>\n",
       "      <th>qualifications</th>\n",
       "      <th>text_keyword</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>6695</td>\n",
       "      <td>6694.000000</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>6695.0</td>\n",
       "      <td>6695.0</td>\n",
       "      <td>6695</td>\n",
       "      <td>6695.000000</td>\n",
       "      <td>6695.000000</td>\n",
       "      <td>6695.000000</td>\n",
       "      <td>707</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>6695</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>761</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>523</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>R02264</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2507;2707</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>영업MD</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1232</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.103675</td>\n",
       "      <td>7.900000</td>\n",
       "      <td>16.555556</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.081703</td>\n",
       "      <td>2.277521</td>\n",
       "      <td>1.317401</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0.955459</td>\n",
       "      <td>7.399836</td>\n",
       "      <td>6.424778</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.753074</td>\n",
       "      <td>1.242267</td>\n",
       "      <td>0.477852</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>14.000000</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>NaN</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       recruitment_seq  address_seq1  address_seq2  address_seq3  career_end  \\\n",
       "count             6695   6694.000000    100.000000      9.000000      6695.0   \n",
       "unique            6695           NaN           NaN           NaN         NaN   \n",
       "top             R02264           NaN           NaN           NaN         NaN   \n",
       "freq                 1           NaN           NaN           NaN         NaN   \n",
       "mean               NaN      3.103675      7.900000     16.555556         0.0   \n",
       "std                NaN      0.955459      7.399836      6.424778         0.0   \n",
       "min                NaN      1.000000      1.000000      3.000000         0.0   \n",
       "25%                NaN      3.000000      1.000000     18.000000         0.0   \n",
       "50%                NaN      3.000000      5.000000     20.000000         0.0   \n",
       "75%                NaN      3.000000     14.000000     20.000000         0.0   \n",
       "max                NaN     20.000000     20.000000     20.000000         0.0   \n",
       "\n",
       "        career_start check_box_keyword    education   major_task  \\\n",
       "count         6695.0              6695  6695.000000  6695.000000   \n",
       "unique           NaN               761          NaN          NaN   \n",
       "top              NaN         2507;2707          NaN          NaN   \n",
       "freq             NaN              1232          NaN          NaN   \n",
       "mean             0.0               NaN     3.081703     2.277521   \n",
       "std              0.0               NaN     0.753074     1.242267   \n",
       "min              0.0               NaN     2.000000     1.000000   \n",
       "25%              0.0               NaN     3.000000     2.000000   \n",
       "50%              0.0               NaN     3.000000     2.000000   \n",
       "75%              0.0               NaN     4.000000     2.000000   \n",
       "max              0.0               NaN     6.000000    10.000000   \n",
       "\n",
       "        qualifications text_keyword  \n",
       "count      6695.000000          707  \n",
       "unique             NaN          523  \n",
       "top                NaN         영업MD  \n",
       "freq               NaN           20  \n",
       "mean          1.317401          NaN  \n",
       "std           0.477852          NaN  \n",
       "min           0.000000          NaN  \n",
       "25%           1.000000          NaN  \n",
       "50%           1.000000          NaN  \n",
       "75%           2.000000          NaN  \n",
       "max           2.000000          NaN  "
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "recruitment.describe(include='all')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R03838</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U06456</td>\n",
       "      <td>R02144</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  resume_seq recruitment_seq\n",
       "0     U05833          R03838\n",
       "1     U06456          R02144"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>reg_date</th>\n",
       "      <th>updated_date</th>\n",
       "      <th>degree</th>\n",
       "      <th>graduate_date</th>\n",
       "      <th>hope_salary</th>\n",
       "      <th>last_salary</th>\n",
       "      <th>text_keyword</th>\n",
       "      <th>job_code_seq1</th>\n",
       "      <th>job_code_seq2</th>\n",
       "      <th>job_code_seq3</th>\n",
       "      <th>career_month</th>\n",
       "      <th>career_job_code</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U00606</td>\n",
       "      <td>2020-03-04</td>\n",
       "      <td>2020-05-22</td>\n",
       "      <td>4</td>\n",
       "      <td>2008</td>\n",
       "      <td>3500.0</td>\n",
       "      <td>3500.0</td>\n",
       "      <td>스타일디자이너;우븐디자이너</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>67</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U00509</td>\n",
       "      <td>2019-08-25</td>\n",
       "      <td>2020-09-02</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3700.0</td>\n",
       "      <td>상품기획;MD;기획;머천다이저;머천다이징</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>84</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  resume_seq    reg_date updated_date  degree  graduate_date  hope_salary  \\\n",
       "0     U00606  2020-03-04   2020-05-22       4           2008       3500.0   \n",
       "1     U00509  2019-08-25   2020-09-02       2              0          0.0   \n",
       "\n",
       "   last_salary            text_keyword job_code_seq1 job_code_seq2  \\\n",
       "0       3500.0          스타일디자이너;우븐디자이너   재료·화학·섬유·의복           NaN   \n",
       "1       3700.0  상품기획;MD;기획;머천다이저;머천다이징   재료·화학·섬유·의복           NaN   \n",
       "\n",
       "  job_code_seq3  career_month career_job_code  \n",
       "0           NaN            67             NaN  \n",
       "1           NaN            84     섬유;봉제;가방;의류  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>address_seq1</th>\n",
       "      <th>address_seq2</th>\n",
       "      <th>address_seq3</th>\n",
       "      <th>career_end</th>\n",
       "      <th>career_start</th>\n",
       "      <th>check_box_keyword</th>\n",
       "      <th>education</th>\n",
       "      <th>major_task</th>\n",
       "      <th>qualifications</th>\n",
       "      <th>text_keyword</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>R02264</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2507;2707;2810</td>\n",
       "      <td>4</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>R06317</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2204;2205;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  recruitment_seq  address_seq1  address_seq2  address_seq3  career_end  \\\n",
       "0          R02264           3.0           NaN           NaN           0   \n",
       "1          R06317           3.0           NaN           NaN           0   \n",
       "\n",
       "   career_start check_box_keyword  education  major_task  qualifications  \\\n",
       "0             0    2507;2707;2810          4           8               1   \n",
       "1             0    2204;2205;2707          3           2               1   \n",
       "\n",
       "  text_keyword  \n",
       "0          NaN  \n",
       "1          NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>certificate_contents</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U06421</td>\n",
       "      <td>손해보험사</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U01278</td>\n",
       "      <td>2종운전면허증</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  resume_seq certificate_contents\n",
       "0     U06421                손해보험사\n",
       "1     U01278              2종운전면허증"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(apply_train.head(2))\n",
    "display(resume.head(2))\n",
    "display(recruitment.head(2))\n",
    "display(resume_certificate.head(2))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "apply_train_origin = apply_train.copy()\n",
    "resume_origin = resume.copy()\n",
    "recruitment_origin = recruitment.copy()\n",
    "resume_certificate_origin = resume_certificate.copy() "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "U02884    10\n",
       "U06784    10\n",
       "U04172    10\n",
       "U03691     9\n",
       "U07438     9\n",
       "          ..\n",
       "U07443     1\n",
       "U06622     1\n",
       "U07288     1\n",
       "U07409     1\n",
       "U06022     1\n",
       "Name: resume_seq, Length: 5976, dtype: int64"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "resume_certificate_origin['resume_seq'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>reg_date</th>\n",
       "      <th>updated_date</th>\n",
       "      <th>degree</th>\n",
       "      <th>graduate_date</th>\n",
       "      <th>hope_salary</th>\n",
       "      <th>last_salary</th>\n",
       "      <th>text_keyword_x</th>\n",
       "      <th>job_code_seq1</th>\n",
       "      <th>...</th>\n",
       "      <th>address_seq1</th>\n",
       "      <th>address_seq2</th>\n",
       "      <th>address_seq3</th>\n",
       "      <th>career_end</th>\n",
       "      <th>career_start</th>\n",
       "      <th>check_box_keyword</th>\n",
       "      <th>education</th>\n",
       "      <th>major_task</th>\n",
       "      <th>qualifications</th>\n",
       "      <th>text_keyword_y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2020-02-28</td>\n",
       "      <td>2020-09-07</td>\n",
       "      <td>4</td>\n",
       "      <td>2000</td>\n",
       "      <td>4500.0</td>\n",
       "      <td>4300.0</td>\n",
       "      <td>생산관리</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U05260</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2018-08-02</td>\n",
       "      <td>2020-07-01</td>\n",
       "      <td>4</td>\n",
       "      <td>2009</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>U04741</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2019-03-27</td>\n",
       "      <td>2020-07-13</td>\n",
       "      <td>4</td>\n",
       "      <td>2011</td>\n",
       "      <td>3300.0</td>\n",
       "      <td>3100.0</td>\n",
       "      <td>상품기획;상품MD;생산관리;중국영업;중국관리;중국사업</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>U05144</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2015-02-03</td>\n",
       "      <td>2020-10-27</td>\n",
       "      <td>4</td>\n",
       "      <td>2012</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>중국무역;상품기획;생산관리;유소아복;여성복;MD;임가공;완사입;라이프스타일;아이웨어...</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>U04622</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2018-04-10</td>\n",
       "      <td>2020-12-09</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3700.0</td>\n",
       "      <td>해외영업;생산관리;중국어</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>U00108</td>\n",
       "      <td>R03242</td>\n",
       "      <td>2020-09-26</td>\n",
       "      <td>2020-11-07</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5250.0</td>\n",
       "      <td>영업기획;영업MD;물량운영;상품기획;아웃도어;스포츠;골프;영업</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2201;2204;2205;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>U00637</td>\n",
       "      <td>R03061</td>\n",
       "      <td>2016-10-17</td>\n",
       "      <td>2020-01-19</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3100.0</td>\n",
       "      <td>홍보마케팅</td>\n",
       "      <td>경영·기획·회계·사무</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2104;2105;2707;3008;3099</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>U00290</td>\n",
       "      <td>R03061</td>\n",
       "      <td>2018-05-24</td>\n",
       "      <td>2020-05-11</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4500.0</td>\n",
       "      <td>스포츠웨어;캐주얼;신발;의류;아동복;스포츠마케팅;패션마케팅;광고기획;이벤트;프로모션...</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2104;2105;2707;3008;3099</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>U06054</td>\n",
       "      <td>R00114</td>\n",
       "      <td>2020-03-15</td>\n",
       "      <td>2020-05-15</td>\n",
       "      <td>4</td>\n",
       "      <td>2016</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>머천다이저;상품기획;남성복;여성복;캐주얼;섬유;생산</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2507;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>U01794</td>\n",
       "      <td>R00114</td>\n",
       "      <td>2020-08-02</td>\n",
       "      <td>2020-08-03</td>\n",
       "      <td>4</td>\n",
       "      <td>2017</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>패션디자인;패션;스트릿;여성복;남성복;캐주얼웨어</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2507;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      resume_seq recruitment_seq    reg_date updated_date  degree  \\\n",
       "0         U05833          R03838  2020-02-28   2020-09-07       4   \n",
       "1         U05260          R03838  2018-08-02   2020-07-01       4   \n",
       "2         U04741          R03838  2019-03-27   2020-07-13       4   \n",
       "3         U05144          R03838  2015-02-03   2020-10-27       4   \n",
       "4         U04622          R03838  2018-04-10   2020-12-09       4   \n",
       "...          ...             ...         ...          ...     ...   \n",
       "57941     U00108          R03242  2020-09-26   2020-11-07       3   \n",
       "57942     U00637          R03061  2016-10-17   2020-01-19       4   \n",
       "57943     U00290          R03061  2018-05-24   2020-05-11       4   \n",
       "57944     U06054          R00114  2020-03-15   2020-05-15       4   \n",
       "57945     U01794          R00114  2020-08-02   2020-08-03       4   \n",
       "\n",
       "       graduate_date  hope_salary  last_salary  \\\n",
       "0               2000       4500.0       4300.0   \n",
       "1               2009          0.0          0.0   \n",
       "2               2011       3300.0       3100.0   \n",
       "3               2012          0.0          0.0   \n",
       "4               2002          0.0       3700.0   \n",
       "...              ...          ...          ...   \n",
       "57941           2005          0.0       5250.0   \n",
       "57942           2002          0.0       3100.0   \n",
       "57943           2002          0.0       4500.0   \n",
       "57944           2016          0.0          0.0   \n",
       "57945           2017          0.0          0.0   \n",
       "\n",
       "                                          text_keyword_x job_code_seq1  ...  \\\n",
       "0                                                   생산관리   재료·화학·섬유·의복  ...   \n",
       "1                                                    NaN   재료·화학·섬유·의복  ...   \n",
       "2                          상품기획;상품MD;생산관리;중국영업;중국관리;중국사업   재료·화학·섬유·의복  ...   \n",
       "3      중국무역;상품기획;생산관리;유소아복;여성복;MD;임가공;완사입;라이프스타일;아이웨어...   재료·화학·섬유·의복  ...   \n",
       "4                                          해외영업;생산관리;중국어   재료·화학·섬유·의복  ...   \n",
       "...                                                  ...           ...  ...   \n",
       "57941                 영업기획;영업MD;물량운영;상품기획;아웃도어;스포츠;골프;영업   재료·화학·섬유·의복  ...   \n",
       "57942                                              홍보마케팅   경영·기획·회계·사무  ...   \n",
       "57943  스포츠웨어;캐주얼;신발;의류;아동복;스포츠마케팅;패션마케팅;광고기획;이벤트;프로모션...   재료·화학·섬유·의복  ...   \n",
       "57944                       머천다이저;상품기획;남성복;여성복;캐주얼;섬유;생산   재료·화학·섬유·의복  ...   \n",
       "57945                         패션디자인;패션;스트릿;여성복;남성복;캐주얼웨어   재료·화학·섬유·의복  ...   \n",
       "\n",
       "      address_seq1 address_seq2  address_seq3 career_end  career_start  \\\n",
       "0              3.0          NaN           NaN          0             0   \n",
       "1              3.0          NaN           NaN          0             0   \n",
       "2              3.0          NaN           NaN          0             0   \n",
       "3              3.0          NaN           NaN          0             0   \n",
       "4              3.0          NaN           NaN          0             0   \n",
       "...            ...          ...           ...        ...           ...   \n",
       "57941          3.0          NaN           NaN          0             0   \n",
       "57942          3.0          NaN           NaN          0             0   \n",
       "57943          3.0          NaN           NaN          0             0   \n",
       "57944          3.0          NaN           NaN          0             0   \n",
       "57945          3.0          NaN           NaN          0             0   \n",
       "\n",
       "                   check_box_keyword  education  major_task  qualifications  \\\n",
       "0                2110;2203;2204;2299          3           2               1   \n",
       "1                2110;2203;2204;2299          3           2               1   \n",
       "2                2110;2203;2204;2299          3           2               1   \n",
       "3                2110;2203;2204;2299          3           2               1   \n",
       "4                2110;2203;2204;2299          3           2               1   \n",
       "...                              ...        ...         ...             ...   \n",
       "57941            2201;2204;2205;2707          3           2               2   \n",
       "57942  2101;2104;2105;2707;3008;3099          4           2               1   \n",
       "57943  2101;2104;2105;2707;3008;3099          4           2               1   \n",
       "57944                      2507;2707          3           7               1   \n",
       "57945                      2507;2707          3           7               1   \n",
       "\n",
       "      text_keyword_y  \n",
       "0                NaN  \n",
       "1                NaN  \n",
       "2                NaN  \n",
       "3                NaN  \n",
       "4                NaN  \n",
       "...              ...  \n",
       "57941            NaN  \n",
       "57942            NaN  \n",
       "57943            NaN  \n",
       "57944            NaN  \n",
       "57945            NaN  \n",
       "\n",
       "[57946 rows x 24 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train = apply_train.merge(resume, on=\"resume_seq\", how='outer').merge(recruitment, on=\"recruitment_seq\", how='outer')\n",
    "train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2     54954\n",
       "8      1906\n",
       "7       797\n",
       "1       248\n",
       "9        21\n",
       "10       15\n",
       "6         5\n",
       "Name: major_task, dtype: int64"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train['major_task'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "resume_seq               0\n",
       "recruitment_seq          0\n",
       "reg_date                 0\n",
       "updated_date             0\n",
       "degree                   0\n",
       "graduate_date            0\n",
       "hope_salary              0\n",
       "last_salary              0\n",
       "text_keyword_x        1202\n",
       "job_code_seq1            0\n",
       "job_code_seq2        55009\n",
       "job_code_seq3        56820\n",
       "career_month             0\n",
       "career_job_code       3389\n",
       "address_seq1             6\n",
       "address_seq2         57069\n",
       "address_seq3         57873\n",
       "career_end               0\n",
       "career_start             0\n",
       "check_box_keyword        0\n",
       "education                0\n",
       "major_task               0\n",
       "qualifications           0\n",
       "text_keyword_y       52337\n",
       "dtype: int64"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>reg_date</th>\n",
       "      <th>updated_date</th>\n",
       "      <th>degree</th>\n",
       "      <th>graduate_date</th>\n",
       "      <th>hope_salary</th>\n",
       "      <th>last_salary</th>\n",
       "      <th>text_keyword_x</th>\n",
       "      <th>job_code_seq1</th>\n",
       "      <th>...</th>\n",
       "      <th>address_seq1</th>\n",
       "      <th>address_seq2</th>\n",
       "      <th>address_seq3</th>\n",
       "      <th>career_end</th>\n",
       "      <th>career_start</th>\n",
       "      <th>check_box_keyword</th>\n",
       "      <th>education</th>\n",
       "      <th>major_task</th>\n",
       "      <th>qualifications</th>\n",
       "      <th>text_keyword_y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2020-02-28</td>\n",
       "      <td>2020-09-07</td>\n",
       "      <td>4</td>\n",
       "      <td>2000</td>\n",
       "      <td>4500.0</td>\n",
       "      <td>4300.0</td>\n",
       "      <td>생산관리</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U05260</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2018-08-02</td>\n",
       "      <td>2020-07-01</td>\n",
       "      <td>4</td>\n",
       "      <td>2009</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>U04741</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2019-03-27</td>\n",
       "      <td>2020-07-13</td>\n",
       "      <td>4</td>\n",
       "      <td>2011</td>\n",
       "      <td>3300.0</td>\n",
       "      <td>3100.0</td>\n",
       "      <td>상품기획;상품MD;생산관리;중국영업;중국관리;중국사업</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>U05144</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2015-02-03</td>\n",
       "      <td>2020-10-27</td>\n",
       "      <td>4</td>\n",
       "      <td>2012</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>중국무역;상품기획;생산관리;유소아복;여성복;MD;임가공;완사입;라이프스타일;아이웨어...</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>U04622</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2018-04-10</td>\n",
       "      <td>2020-12-09</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3700.0</td>\n",
       "      <td>해외영업;생산관리;중국어</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>U00108</td>\n",
       "      <td>R03242</td>\n",
       "      <td>2020-09-26</td>\n",
       "      <td>2020-11-07</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5250.0</td>\n",
       "      <td>영업기획;영업MD;물량운영;상품기획;아웃도어;스포츠;골프;영업</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2201;2204;2205;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>U00637</td>\n",
       "      <td>R03061</td>\n",
       "      <td>2016-10-17</td>\n",
       "      <td>2020-01-19</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3100.0</td>\n",
       "      <td>홍보마케팅</td>\n",
       "      <td>경영·기획·회계·사무</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2104;2105;2707;3008;3099</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>U00290</td>\n",
       "      <td>R03061</td>\n",
       "      <td>2018-05-24</td>\n",
       "      <td>2020-05-11</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4500.0</td>\n",
       "      <td>스포츠웨어;캐주얼;신발;의류;아동복;스포츠마케팅;패션마케팅;광고기획;이벤트;프로모션...</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2104;2105;2707;3008;3099</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>U06054</td>\n",
       "      <td>R00114</td>\n",
       "      <td>2020-03-15</td>\n",
       "      <td>2020-05-15</td>\n",
       "      <td>4</td>\n",
       "      <td>2016</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>머천다이저;상품기획;남성복;여성복;캐주얼;섬유;생산</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2507;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>U01794</td>\n",
       "      <td>R00114</td>\n",
       "      <td>2020-08-02</td>\n",
       "      <td>2020-08-03</td>\n",
       "      <td>4</td>\n",
       "      <td>2017</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>패션디자인;패션;스트릿;여성복;남성복;캐주얼웨어</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2507;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      resume_seq recruitment_seq    reg_date updated_date  degree  \\\n",
       "0         U05833          R03838  2020-02-28   2020-09-07       4   \n",
       "1         U05260          R03838  2018-08-02   2020-07-01       4   \n",
       "2         U04741          R03838  2019-03-27   2020-07-13       4   \n",
       "3         U05144          R03838  2015-02-03   2020-10-27       4   \n",
       "4         U04622          R03838  2018-04-10   2020-12-09       4   \n",
       "...          ...             ...         ...          ...     ...   \n",
       "57941     U00108          R03242  2020-09-26   2020-11-07       3   \n",
       "57942     U00637          R03061  2016-10-17   2020-01-19       4   \n",
       "57943     U00290          R03061  2018-05-24   2020-05-11       4   \n",
       "57944     U06054          R00114  2020-03-15   2020-05-15       4   \n",
       "57945     U01794          R00114  2020-08-02   2020-08-03       4   \n",
       "\n",
       "       graduate_date  hope_salary  last_salary  \\\n",
       "0               2000       4500.0       4300.0   \n",
       "1               2009          0.0          0.0   \n",
       "2               2011       3300.0       3100.0   \n",
       "3               2012          0.0          0.0   \n",
       "4               2002          0.0       3700.0   \n",
       "...              ...          ...          ...   \n",
       "57941           2005          0.0       5250.0   \n",
       "57942           2002          0.0       3100.0   \n",
       "57943           2002          0.0       4500.0   \n",
       "57944           2016          0.0          0.0   \n",
       "57945           2017          0.0          0.0   \n",
       "\n",
       "                                          text_keyword_x job_code_seq1  ...  \\\n",
       "0                                                   생산관리   재료·화학·섬유·의복  ...   \n",
       "1                                                    NaN   재료·화학·섬유·의복  ...   \n",
       "2                          상품기획;상품MD;생산관리;중국영업;중국관리;중국사업   재료·화학·섬유·의복  ...   \n",
       "3      중국무역;상품기획;생산관리;유소아복;여성복;MD;임가공;완사입;라이프스타일;아이웨어...   재료·화학·섬유·의복  ...   \n",
       "4                                          해외영업;생산관리;중국어   재료·화학·섬유·의복  ...   \n",
       "...                                                  ...           ...  ...   \n",
       "57941                 영업기획;영업MD;물량운영;상품기획;아웃도어;스포츠;골프;영업   재료·화학·섬유·의복  ...   \n",
       "57942                                              홍보마케팅   경영·기획·회계·사무  ...   \n",
       "57943  스포츠웨어;캐주얼;신발;의류;아동복;스포츠마케팅;패션마케팅;광고기획;이벤트;프로모션...   재료·화학·섬유·의복  ...   \n",
       "57944                       머천다이저;상품기획;남성복;여성복;캐주얼;섬유;생산   재료·화학·섬유·의복  ...   \n",
       "57945                         패션디자인;패션;스트릿;여성복;남성복;캐주얼웨어   재료·화학·섬유·의복  ...   \n",
       "\n",
       "      address_seq1 address_seq2  address_seq3 career_end  career_start  \\\n",
       "0              3.0          NaN           NaN          0             0   \n",
       "1              3.0          NaN           NaN          0             0   \n",
       "2              3.0          NaN           NaN          0             0   \n",
       "3              3.0          NaN           NaN          0             0   \n",
       "4              3.0          NaN           NaN          0             0   \n",
       "...            ...          ...           ...        ...           ...   \n",
       "57941          3.0          NaN           NaN          0             0   \n",
       "57942          3.0          NaN           NaN          0             0   \n",
       "57943          3.0          NaN           NaN          0             0   \n",
       "57944          3.0          NaN           NaN          0             0   \n",
       "57945          3.0          NaN           NaN          0             0   \n",
       "\n",
       "                   check_box_keyword  education  major_task  qualifications  \\\n",
       "0                2110;2203;2204;2299          3           2               1   \n",
       "1                2110;2203;2204;2299          3           2               1   \n",
       "2                2110;2203;2204;2299          3           2               1   \n",
       "3                2110;2203;2204;2299          3           2               1   \n",
       "4                2110;2203;2204;2299          3           2               1   \n",
       "...                              ...        ...         ...             ...   \n",
       "57941            2201;2204;2205;2707          3           2               2   \n",
       "57942  2101;2104;2105;2707;3008;3099          4           2               1   \n",
       "57943  2101;2104;2105;2707;3008;3099          4           2               1   \n",
       "57944                      2507;2707          3           7               1   \n",
       "57945                      2507;2707          3           7               1   \n",
       "\n",
       "      text_keyword_y  \n",
       "0                NaN  \n",
       "1                NaN  \n",
       "2                NaN  \n",
       "3                NaN  \n",
       "4                NaN  \n",
       "...              ...  \n",
       "57941            NaN  \n",
       "57942            NaN  \n",
       "57943            NaN  \n",
       "57944            NaN  \n",
       "57945            NaN  \n",
       "\n",
       "[57946 rows x 24 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['resume_seq', 'recruitment_seq', 'reg_date', 'updated_date', 'degree',\n",
       "       'graduate_date', 'hope_salary', 'last_salary', 'text_keyword_x',\n",
       "       'job_code_seq1', 'job_code_seq2', 'job_code_seq3', 'career_month',\n",
       "       'career_job_code', 'address_seq1', 'address_seq2', 'address_seq3',\n",
       "       'career_end', 'career_start', 'check_box_keyword', 'education',\n",
       "       'major_task', 'qualifications', 'text_keyword_y'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "(train.isna().sum() !=0).index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(57946, 24)"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>reg_date</th>\n",
       "      <th>updated_date</th>\n",
       "      <th>degree</th>\n",
       "      <th>graduate_date</th>\n",
       "      <th>hope_salary</th>\n",
       "      <th>last_salary</th>\n",
       "      <th>text_keyword_x</th>\n",
       "      <th>job_code_seq1</th>\n",
       "      <th>...</th>\n",
       "      <th>address_seq1</th>\n",
       "      <th>address_seq2</th>\n",
       "      <th>address_seq3</th>\n",
       "      <th>career_end</th>\n",
       "      <th>career_start</th>\n",
       "      <th>check_box_keyword</th>\n",
       "      <th>education</th>\n",
       "      <th>major_task</th>\n",
       "      <th>qualifications</th>\n",
       "      <th>text_keyword_y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>488</th>\n",
       "      <td>U01045</td>\n",
       "      <td>R04356</td>\n",
       "      <td>2013-03-01</td>\n",
       "      <td>2020-10-19</td>\n",
       "      <td>4</td>\n",
       "      <td>2006</td>\n",
       "      <td>3900.0</td>\n",
       "      <td>3700.0</td>\n",
       "      <td>백화점영업;대리점영업</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2201;2204;2205;2707</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>영업;백화점;영업관리;여성복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>489</th>\n",
       "      <td>U03148</td>\n",
       "      <td>R04356</td>\n",
       "      <td>2018-03-30</td>\n",
       "      <td>2020-04-28</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>3500.0</td>\n",
       "      <td>3500.0</td>\n",
       "      <td>영업;유통</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2201;2204;2205;2707</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>영업;백화점;영업관리;여성복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>490</th>\n",
       "      <td>U03142</td>\n",
       "      <td>R04356</td>\n",
       "      <td>2009-06-20</td>\n",
       "      <td>2020-10-02</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3700.0</td>\n",
       "      <td>매장영업관리;매장관리;백화점영업;대리점영업;의류영업;골프영업</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2201;2204;2205;2707</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>영업;백화점;영업관리;여성복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>491</th>\n",
       "      <td>U06125</td>\n",
       "      <td>R04356</td>\n",
       "      <td>2013-10-03</td>\n",
       "      <td>2020-02-26</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>매장영업;인원;매출;바이어상담;개설상담MD개편;매장개설등</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2201;2204;2205;2707</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>영업;백화점;영업관리;여성복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>492</th>\n",
       "      <td>U07042</td>\n",
       "      <td>R04356</td>\n",
       "      <td>2001-08-17</td>\n",
       "      <td>2020-07-25</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>영업;영업관리;백화점;대리점;매장관리</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2201;2204;2205;2707</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>영업;백화점;영업관리;여성복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57903</th>\n",
       "      <td>U03563</td>\n",
       "      <td>R05442</td>\n",
       "      <td>2019-12-02</td>\n",
       "      <td>2020-10-19</td>\n",
       "      <td>4</td>\n",
       "      <td>2019</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>패션디자인;여성복디자인</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2507;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>디자이너;디자인</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57904</th>\n",
       "      <td>U07537</td>\n",
       "      <td>R05442</td>\n",
       "      <td>2020-04-08</td>\n",
       "      <td>2020-06-24</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>패션디자인;여성복;캐주얼디자인;영캐주얼;디자이너;포토샵;일러스트</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2507;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>디자이너;디자인</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57913</th>\n",
       "      <td>U00988</td>\n",
       "      <td>R05176</td>\n",
       "      <td>2020-02-22</td>\n",
       "      <td>2020-08-18</td>\n",
       "      <td>4</td>\n",
       "      <td>2019</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>VMD;비주얼머천다이저;디스플레이;그래픽디자인</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2204;2205;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>라운딩;매장;VMD;코디;오브제</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57914</th>\n",
       "      <td>U02983</td>\n",
       "      <td>R05176</td>\n",
       "      <td>2020-03-05</td>\n",
       "      <td>2020-12-11</td>\n",
       "      <td>5</td>\n",
       "      <td>2020</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2100.0</td>\n",
       "      <td>MD;상품기획;마케팅;패션디자인;스타일디자인;컬러디자인;시각디자인;VMD;비주얼머천다이징</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2204;2205;2707</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>라운딩;매장;VMD;코디;오브제</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57939</th>\n",
       "      <td>U02927</td>\n",
       "      <td>R05058</td>\n",
       "      <td>2013-06-29</td>\n",
       "      <td>2020-02-02</td>\n",
       "      <td>4</td>\n",
       "      <td>2011</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4900.0</td>\n",
       "      <td>영업기획;의류;잡화;캐주얼</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "      <td>...</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2108;2201;2707</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>커리어;로드샵;여성복</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5609 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      resume_seq recruitment_seq    reg_date updated_date  degree  \\\n",
       "488       U01045          R04356  2013-03-01   2020-10-19       4   \n",
       "489       U03148          R04356  2018-03-30   2020-04-28       3   \n",
       "490       U03142          R04356  2009-06-20   2020-10-02       4   \n",
       "491       U06125          R04356  2013-10-03   2020-02-26       4   \n",
       "492       U07042          R04356  2001-08-17   2020-07-25       4   \n",
       "...          ...             ...         ...          ...     ...   \n",
       "57903     U03563          R05442  2019-12-02   2020-10-19       4   \n",
       "57904     U07537          R05442  2020-04-08   2020-06-24       4   \n",
       "57913     U00988          R05176  2020-02-22   2020-08-18       4   \n",
       "57914     U02983          R05176  2020-03-05   2020-12-11       5   \n",
       "57939     U02927          R05058  2013-06-29   2020-02-02       4   \n",
       "\n",
       "       graduate_date  hope_salary  last_salary  \\\n",
       "488             2006       3900.0       3700.0   \n",
       "489                0       3500.0       3500.0   \n",
       "490             2002          0.0       3700.0   \n",
       "491             2002          0.0          0.0   \n",
       "492             2002      10000.0      10000.0   \n",
       "...              ...          ...          ...   \n",
       "57903           2019          0.0          0.0   \n",
       "57904              0          0.0          0.0   \n",
       "57913           2019       2500.0       2500.0   \n",
       "57914           2020          0.0       2100.0   \n",
       "57939           2011          0.0       4900.0   \n",
       "\n",
       "                                          text_keyword_x job_code_seq1  ...  \\\n",
       "488                                          백화점영업;대리점영업   재료·화학·섬유·의복  ...   \n",
       "489                                                영업;유통   재료·화학·섬유·의복  ...   \n",
       "490                    매장영업관리;매장관리;백화점영업;대리점영업;의류영업;골프영업   재료·화학·섬유·의복  ...   \n",
       "491                      매장영업;인원;매출;바이어상담;개설상담MD개편;매장개설등   재료·화학·섬유·의복  ...   \n",
       "492                                 영업;영업관리;백화점;대리점;매장관리   재료·화학·섬유·의복  ...   \n",
       "...                                                  ...           ...  ...   \n",
       "57903                                       패션디자인;여성복디자인   재료·화학·섬유·의복  ...   \n",
       "57904                패션디자인;여성복;캐주얼디자인;영캐주얼;디자이너;포토샵;일러스트   재료·화학·섬유·의복  ...   \n",
       "57913                          VMD;비주얼머천다이저;디스플레이;그래픽디자인   재료·화학·섬유·의복  ...   \n",
       "57914  MD;상품기획;마케팅;패션디자인;스타일디자인;컬러디자인;시각디자인;VMD;비주얼머천다이징   재료·화학·섬유·의복  ...   \n",
       "57939                                     영업기획;의류;잡화;캐주얼   재료·화학·섬유·의복  ...   \n",
       "\n",
       "      address_seq1 address_seq2  address_seq3 career_end  career_start  \\\n",
       "488            3.0          NaN           NaN          0             0   \n",
       "489            3.0          NaN           NaN          0             0   \n",
       "490            3.0          NaN           NaN          0             0   \n",
       "491            3.0          NaN           NaN          0             0   \n",
       "492            3.0          NaN           NaN          0             0   \n",
       "...            ...          ...           ...        ...           ...   \n",
       "57903          3.0          NaN           NaN          0             0   \n",
       "57904          3.0          NaN           NaN          0             0   \n",
       "57913          3.0          NaN           NaN          0             0   \n",
       "57914          3.0          NaN           NaN          0             0   \n",
       "57939          3.0          NaN           NaN          0             0   \n",
       "\n",
       "              check_box_keyword  education  major_task  qualifications  \\\n",
       "488    2101;2201;2204;2205;2707          2           2               1   \n",
       "489    2101;2201;2204;2205;2707          2           2               1   \n",
       "490    2101;2201;2204;2205;2707          2           2               1   \n",
       "491    2101;2201;2204;2205;2707          2           2               1   \n",
       "492    2101;2201;2204;2205;2707          2           2               1   \n",
       "...                         ...        ...         ...             ...   \n",
       "57903                 2507;2707          3           2               1   \n",
       "57904                 2507;2707          3           2               1   \n",
       "57913            2204;2205;2707          3           2               2   \n",
       "57914            2204;2205;2707          3           2               2   \n",
       "57939       2101;2108;2201;2707          4           2               1   \n",
       "\n",
       "          text_keyword_y  \n",
       "488      영업;백화점;영업관리;여성복  \n",
       "489      영업;백화점;영업관리;여성복  \n",
       "490      영업;백화점;영업관리;여성복  \n",
       "491      영업;백화점;영업관리;여성복  \n",
       "492      영업;백화점;영업관리;여성복  \n",
       "...                  ...  \n",
       "57903           디자이너;디자인  \n",
       "57904           디자이너;디자인  \n",
       "57913  라운딩;매장;VMD;코디;오브제  \n",
       "57914  라운딩;매장;VMD;코디;오브제  \n",
       "57939        커리어;로드샵;여성복  \n",
       "\n",
       "[5609 rows x 24 columns]"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train[~train['text_keyword_y'].isna()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    57946\n",
       "Name: career_start, dtype: int64"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train['career_start'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    57946\n",
       "Name: career_end, dtype: int64"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train['career_end'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "resume_seq               0\n",
       "recruitment_seq          0\n",
       "reg_date                 0\n",
       "updated_date             0\n",
       "degree                   0\n",
       "graduate_date            0\n",
       "hope_salary              0\n",
       "last_salary              0\n",
       "text_keyword_x        1202\n",
       "job_code_seq1            0\n",
       "job_code_seq2        55009\n",
       "job_code_seq3        56820\n",
       "career_month             0\n",
       "career_job_code       3389\n",
       "address_seq1             6\n",
       "address_seq2         57069\n",
       "address_seq3         57873\n",
       "career_end               0\n",
       "career_start             0\n",
       "check_box_keyword        0\n",
       "education                0\n",
       "major_task               0\n",
       "qualifications           0\n",
       "text_keyword_y       52337\n",
       "dtype: int64"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>reg_date</th>\n",
       "      <th>updated_date</th>\n",
       "      <th>degree</th>\n",
       "      <th>graduate_date</th>\n",
       "      <th>hope_salary</th>\n",
       "      <th>last_salary</th>\n",
       "      <th>text_keyword_x</th>\n",
       "      <th>job_code_seq1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2020-02-28</td>\n",
       "      <td>2020-09-07</td>\n",
       "      <td>4</td>\n",
       "      <td>2000</td>\n",
       "      <td>4500.0</td>\n",
       "      <td>4300.0</td>\n",
       "      <td>생산관리</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U05260</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2018-08-02</td>\n",
       "      <td>2020-07-01</td>\n",
       "      <td>4</td>\n",
       "      <td>2009</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>U04741</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2019-03-27</td>\n",
       "      <td>2020-07-13</td>\n",
       "      <td>4</td>\n",
       "      <td>2011</td>\n",
       "      <td>3300.0</td>\n",
       "      <td>3100.0</td>\n",
       "      <td>상품기획;상품MD;생산관리;중국영업;중국관리;중국사업</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>U05144</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2015-02-03</td>\n",
       "      <td>2020-10-27</td>\n",
       "      <td>4</td>\n",
       "      <td>2012</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>중국무역;상품기획;생산관리;유소아복;여성복;MD;임가공;완사입;라이프스타일;아이웨어...</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>U04622</td>\n",
       "      <td>R03838</td>\n",
       "      <td>2018-04-10</td>\n",
       "      <td>2020-12-09</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3700.0</td>\n",
       "      <td>해외영업;생산관리;중국어</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>U00108</td>\n",
       "      <td>R03242</td>\n",
       "      <td>2020-09-26</td>\n",
       "      <td>2020-11-07</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5250.0</td>\n",
       "      <td>영업기획;영업MD;물량운영;상품기획;아웃도어;스포츠;골프;영업</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>U00637</td>\n",
       "      <td>R03061</td>\n",
       "      <td>2016-10-17</td>\n",
       "      <td>2020-01-19</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3100.0</td>\n",
       "      <td>홍보마케팅</td>\n",
       "      <td>경영·기획·회계·사무</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>U00290</td>\n",
       "      <td>R03061</td>\n",
       "      <td>2018-05-24</td>\n",
       "      <td>2020-05-11</td>\n",
       "      <td>4</td>\n",
       "      <td>2002</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4500.0</td>\n",
       "      <td>스포츠웨어;캐주얼;신발;의류;아동복;스포츠마케팅;패션마케팅;광고기획;이벤트;프로모션...</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>U06054</td>\n",
       "      <td>R00114</td>\n",
       "      <td>2020-03-15</td>\n",
       "      <td>2020-05-15</td>\n",
       "      <td>4</td>\n",
       "      <td>2016</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>머천다이저;상품기획;남성복;여성복;캐주얼;섬유;생산</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>U01794</td>\n",
       "      <td>R00114</td>\n",
       "      <td>2020-08-02</td>\n",
       "      <td>2020-08-03</td>\n",
       "      <td>4</td>\n",
       "      <td>2017</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>패션디자인;패션;스트릿;여성복;남성복;캐주얼웨어</td>\n",
       "      <td>재료·화학·섬유·의복</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      resume_seq recruitment_seq    reg_date updated_date  degree  \\\n",
       "0         U05833          R03838  2020-02-28   2020-09-07       4   \n",
       "1         U05260          R03838  2018-08-02   2020-07-01       4   \n",
       "2         U04741          R03838  2019-03-27   2020-07-13       4   \n",
       "3         U05144          R03838  2015-02-03   2020-10-27       4   \n",
       "4         U04622          R03838  2018-04-10   2020-12-09       4   \n",
       "...          ...             ...         ...          ...     ...   \n",
       "57941     U00108          R03242  2020-09-26   2020-11-07       3   \n",
       "57942     U00637          R03061  2016-10-17   2020-01-19       4   \n",
       "57943     U00290          R03061  2018-05-24   2020-05-11       4   \n",
       "57944     U06054          R00114  2020-03-15   2020-05-15       4   \n",
       "57945     U01794          R00114  2020-08-02   2020-08-03       4   \n",
       "\n",
       "       graduate_date  hope_salary  last_salary  \\\n",
       "0               2000       4500.0       4300.0   \n",
       "1               2009          0.0          0.0   \n",
       "2               2011       3300.0       3100.0   \n",
       "3               2012          0.0          0.0   \n",
       "4               2002          0.0       3700.0   \n",
       "...              ...          ...          ...   \n",
       "57941           2005          0.0       5250.0   \n",
       "57942           2002          0.0       3100.0   \n",
       "57943           2002          0.0       4500.0   \n",
       "57944           2016          0.0          0.0   \n",
       "57945           2017          0.0          0.0   \n",
       "\n",
       "                                          text_keyword_x job_code_seq1  \n",
       "0                                                   생산관리   재료·화학·섬유·의복  \n",
       "1                                                    NaN   재료·화학·섬유·의복  \n",
       "2                          상품기획;상품MD;생산관리;중국영업;중국관리;중국사업   재료·화학·섬유·의복  \n",
       "3      중국무역;상품기획;생산관리;유소아복;여성복;MD;임가공;완사입;라이프스타일;아이웨어...   재료·화학·섬유·의복  \n",
       "4                                          해외영업;생산관리;중국어   재료·화학·섬유·의복  \n",
       "...                                                  ...           ...  \n",
       "57941                 영업기획;영업MD;물량운영;상품기획;아웃도어;스포츠;골프;영업   재료·화학·섬유·의복  \n",
       "57942                                              홍보마케팅   경영·기획·회계·사무  \n",
       "57943  스포츠웨어;캐주얼;신발;의류;아동복;스포츠마케팅;패션마케팅;광고기획;이벤트;프로모션...   재료·화학·섬유·의복  \n",
       "57944                       머천다이저;상품기획;남성복;여성복;캐주얼;섬유;생산   재료·화학·섬유·의복  \n",
       "57945                         패션디자인;패션;스트릿;여성복;남성복;캐주얼웨어   재료·화학·섬유·의복  \n",
       "\n",
       "[57946 rows x 10 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>job_code_seq2</th>\n",
       "      <th>job_code_seq3</th>\n",
       "      <th>career_month</th>\n",
       "      <th>career_job_code</th>\n",
       "      <th>address_seq1</th>\n",
       "      <th>address_seq2</th>\n",
       "      <th>address_seq3</th>\n",
       "      <th>career_end</th>\n",
       "      <th>career_start</th>\n",
       "      <th>check_box_keyword</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>175</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>83</td>\n",
       "      <td>자동차;운송장비;조선;항공</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>33</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>136</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>117</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2110;2203;2204;2299</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>151</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2201;2204;2205;2707</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>84</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2104;2105;2707;3008;3099</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>164</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2101;2104;2105;2707;3008;3099</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>88</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2507;2707</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6</td>\n",
       "      <td>섬유;봉제;가방;의류</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2507;2707</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      job_code_seq2 job_code_seq3  career_month career_job_code  address_seq1  \\\n",
       "0               NaN           NaN           175     섬유;봉제;가방;의류           3.0   \n",
       "1               NaN           NaN            83  자동차;운송장비;조선;항공           3.0   \n",
       "2               NaN           NaN            33     섬유;봉제;가방;의류           3.0   \n",
       "3               NaN           NaN           136     섬유;봉제;가방;의류           3.0   \n",
       "4               NaN           NaN           117     섬유;봉제;가방;의류           3.0   \n",
       "...             ...           ...           ...             ...           ...   \n",
       "57941           NaN           NaN           151     섬유;봉제;가방;의류           3.0   \n",
       "57942           NaN           NaN            84     섬유;봉제;가방;의류           3.0   \n",
       "57943           NaN           NaN           164     섬유;봉제;가방;의류           3.0   \n",
       "57944           NaN           NaN            88     섬유;봉제;가방;의류           3.0   \n",
       "57945           NaN           NaN             6     섬유;봉제;가방;의류           3.0   \n",
       "\n",
       "       address_seq2  address_seq3  career_end  career_start  \\\n",
       "0               NaN           NaN           0             0   \n",
       "1               NaN           NaN           0             0   \n",
       "2               NaN           NaN           0             0   \n",
       "3               NaN           NaN           0             0   \n",
       "4               NaN           NaN           0             0   \n",
       "...             ...           ...         ...           ...   \n",
       "57941           NaN           NaN           0             0   \n",
       "57942           NaN           NaN           0             0   \n",
       "57943           NaN           NaN           0             0   \n",
       "57944           NaN           NaN           0             0   \n",
       "57945           NaN           NaN           0             0   \n",
       "\n",
       "                   check_box_keyword  \n",
       "0                2110;2203;2204;2299  \n",
       "1                2110;2203;2204;2299  \n",
       "2                2110;2203;2204;2299  \n",
       "3                2110;2203;2204;2299  \n",
       "4                2110;2203;2204;2299  \n",
       "...                              ...  \n",
       "57941            2201;2204;2205;2707  \n",
       "57942  2101;2104;2105;2707;3008;3099  \n",
       "57943  2101;2104;2105;2707;3008;3099  \n",
       "57944                      2507;2707  \n",
       "57945                      2507;2707  \n",
       "\n",
       "[57946 rows x 10 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>education</th>\n",
       "      <th>major_task</th>\n",
       "      <th>qualifications</th>\n",
       "      <th>text_keyword_y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       education  major_task  qualifications text_keyword_y\n",
       "0              3           2               1            NaN\n",
       "1              3           2               1            NaN\n",
       "2              3           2               1            NaN\n",
       "3              3           2               1            NaN\n",
       "4              3           2               1            NaN\n",
       "...          ...         ...             ...            ...\n",
       "57941          3           2               2            NaN\n",
       "57942          4           2               1            NaN\n",
       "57943          4           2               1            NaN\n",
       "57944          3           7               1            NaN\n",
       "57945          3           7               1            NaN\n",
       "\n",
       "[57946 rows x 4 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(train[(train.isna().sum() !=0).index[0:10]])\n",
    "display(train[(train.isna().sum() !=0).index[10:20]])\n",
    "display(train[(train.isna().sum() !=0).index[20:30]])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "train.fillna('Nan',inplace= True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 307,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>degree</th>\n",
       "      <th>text_keyword_x</th>\n",
       "      <th>education</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>생산관리</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U05260</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>Nan</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>U04741</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>상품기획;상품MD;생산관리;중국영업;중국관리;중국사업</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>U05144</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>중국무역;상품기획;생산관리;유소아복;여성복;MD;임가공;완사입;라이프스타일;아이웨어...</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>U04622</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>해외영업;생산관리;중국어</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>U00108</td>\n",
       "      <td>R03242</td>\n",
       "      <td>3</td>\n",
       "      <td>영업기획;영업MD;물량운영;상품기획;아웃도어;스포츠;골프;영업</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>U00637</td>\n",
       "      <td>R03061</td>\n",
       "      <td>4</td>\n",
       "      <td>홍보마케팅</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>U00290</td>\n",
       "      <td>R03061</td>\n",
       "      <td>4</td>\n",
       "      <td>스포츠웨어;캐주얼;신발;의류;아동복;스포츠마케팅;패션마케팅;광고기획;이벤트;프로모션...</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>U06054</td>\n",
       "      <td>R00114</td>\n",
       "      <td>4</td>\n",
       "      <td>머천다이저;상품기획;남성복;여성복;캐주얼;섬유;생산</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>U01794</td>\n",
       "      <td>R00114</td>\n",
       "      <td>4</td>\n",
       "      <td>패션디자인;패션;스트릿;여성복;남성복;캐주얼웨어</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      resume_seq recruitment_seq  degree  \\\n",
       "0         U05833          R03838       4   \n",
       "1         U05260          R03838       4   \n",
       "2         U04741          R03838       4   \n",
       "3         U05144          R03838       4   \n",
       "4         U04622          R03838       4   \n",
       "...          ...             ...     ...   \n",
       "57941     U00108          R03242       3   \n",
       "57942     U00637          R03061       4   \n",
       "57943     U00290          R03061       4   \n",
       "57944     U06054          R00114       4   \n",
       "57945     U01794          R00114       4   \n",
       "\n",
       "                                          text_keyword_x  education  \n",
       "0                                                   생산관리          3  \n",
       "1                                                    Nan          3  \n",
       "2                          상품기획;상품MD;생산관리;중국영업;중국관리;중국사업          3  \n",
       "3      중국무역;상품기획;생산관리;유소아복;여성복;MD;임가공;완사입;라이프스타일;아이웨어...          3  \n",
       "4                                          해외영업;생산관리;중국어          3  \n",
       "...                                                  ...        ...  \n",
       "57941                 영업기획;영업MD;물량운영;상품기획;아웃도어;스포츠;골프;영업          3  \n",
       "57942                                              홍보마케팅          4  \n",
       "57943  스포츠웨어;캐주얼;신발;의류;아동복;스포츠마케팅;패션마케팅;광고기획;이벤트;프로모션...          4  \n",
       "57944                       머천다이저;상품기획;남성복;여성복;캐주얼;섬유;생산          3  \n",
       "57945                         패션디자인;패션;스트릿;여성복;남성복;캐주얼웨어          3  \n",
       "\n",
       "[57946 rows x 5 columns]"
      ]
     },
     "execution_count": 307,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "interaction_data = train[['resume_seq', 'recruitment_seq', 'degree', 'text_keyword_x', 'education']]   # resume_seq(label encoding), text_keyword, job_code_seq\n",
    "interaction_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 308,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/tmp/ipykernel_39463/53351066.py:14: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  interaction_data['text_keyword_x'] = interaction_data['text_keyword_x'].apply(find_representative_word)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>degree</th>\n",
       "      <th>text_keyword_x</th>\n",
       "      <th>education</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>생산관리</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U05260</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>Nan</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>U04741</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>상품기획</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>U05144</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>중국무역</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>U04622</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>해외영업</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>U00108</td>\n",
       "      <td>R03242</td>\n",
       "      <td>3</td>\n",
       "      <td>영업기획</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>U00637</td>\n",
       "      <td>R03061</td>\n",
       "      <td>4</td>\n",
       "      <td>홍보마케팅</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>U00290</td>\n",
       "      <td>R03061</td>\n",
       "      <td>4</td>\n",
       "      <td>스포츠웨어</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>U06054</td>\n",
       "      <td>R00114</td>\n",
       "      <td>4</td>\n",
       "      <td>머천다이저</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>U01794</td>\n",
       "      <td>R00114</td>\n",
       "      <td>4</td>\n",
       "      <td>패션디자인</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      resume_seq recruitment_seq  degree text_keyword_x  education\n",
       "0         U05833          R03838       4           생산관리          3\n",
       "1         U05260          R03838       4            Nan          3\n",
       "2         U04741          R03838       4           상품기획          3\n",
       "3         U05144          R03838       4           중국무역          3\n",
       "4         U04622          R03838       4           해외영업          3\n",
       "...          ...             ...     ...            ...        ...\n",
       "57941     U00108          R03242       3           영업기획          3\n",
       "57942     U00637          R03061       4          홍보마케팅          4\n",
       "57943     U00290          R03061       4          스포츠웨어          4\n",
       "57944     U06054          R00114       4          머천다이저          3\n",
       "57945     U01794          R00114       4          패션디자인          3\n",
       "\n",
       "[57946 rows x 5 columns]"
      ]
     },
     "execution_count": 308,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from collections import Counter\n",
    "\n",
    "def find_representative_word(text):\n",
    "    # 단어 빈도 계산\n",
    "    words = text.split(';')\n",
    "    word_counts = Counter(words)\n",
    "    \n",
    "    # 가장 많이 등장한 단어를 대표 단어로 선택\n",
    "    representative_word = word_counts.most_common(1)[0][0]\n",
    "    \n",
    "    return representative_word\n",
    "\n",
    "# 'text_keyword_x' 열에 대해 새로운 열 'representative_word' 추가\n",
    "interaction_data['text_keyword_x'] = interaction_data['text_keyword_x'].apply(find_representative_word)\n",
    "\n",
    "# 결과 출력\n",
    "interaction_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 309,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>degree</th>\n",
       "      <th>text_keyword_x</th>\n",
       "      <th>education</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>생산관리</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U05260</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>Nan</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>U04741</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>상품기획</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>U05144</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>중국무역</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>U04622</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>해외영업</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>U00108</td>\n",
       "      <td>R03242</td>\n",
       "      <td>3</td>\n",
       "      <td>영업기획</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>U00637</td>\n",
       "      <td>R03061</td>\n",
       "      <td>4</td>\n",
       "      <td>홍보마케팅</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>U00290</td>\n",
       "      <td>R03061</td>\n",
       "      <td>4</td>\n",
       "      <td>스포츠웨어</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>U06054</td>\n",
       "      <td>R00114</td>\n",
       "      <td>4</td>\n",
       "      <td>머천다이저</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>U01794</td>\n",
       "      <td>R00114</td>\n",
       "      <td>4</td>\n",
       "      <td>패션디자인</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      resume_seq recruitment_seq  degree text_keyword_x  education\n",
       "0         U05833          R03838       4           생산관리          3\n",
       "1         U05260          R03838       4            Nan          3\n",
       "2         U04741          R03838       4           상품기획          3\n",
       "3         U05144          R03838       4           중국무역          3\n",
       "4         U04622          R03838       4           해외영업          3\n",
       "...          ...             ...     ...            ...        ...\n",
       "57941     U00108          R03242       3           영업기획          3\n",
       "57942     U00637          R03061       4          홍보마케팅          4\n",
       "57943     U00290          R03061       4          스포츠웨어          4\n",
       "57944     U06054          R00114       4          머천다이저          3\n",
       "57945     U01794          R00114       4          패션디자인          3\n",
       "\n",
       "[57946 rows x 5 columns]"
      ]
     },
     "execution_count": 309,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "interaction_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 310,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/tmp/ipykernel_39463/2188434781.py:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  interaction_data['text_keyword_x'] = label_encoder.fit_transform(interaction_data['text_keyword_x'])\n"
     ]
    }
   ],
   "source": [
    "label_encoder = LabelEncoder()\n",
    "\n",
    "# 'text_keyword_x' 열에 라벨 인코딩 적용\n",
    "interaction_data['text_keyword_x'] = label_encoder.fit_transform(interaction_data['text_keyword_x'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 311,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>degree</th>\n",
       "      <th>text_keyword_x</th>\n",
       "      <th>education</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>535</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U05260</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>42</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>U04741</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>479</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>U05144</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>1037</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>U04622</td>\n",
       "      <td>R03838</td>\n",
       "      <td>4</td>\n",
       "      <td>1219</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>U00108</td>\n",
       "      <td>R03242</td>\n",
       "      <td>3</td>\n",
       "      <td>784</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>U00637</td>\n",
       "      <td>R03061</td>\n",
       "      <td>4</td>\n",
       "      <td>1234</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>U00290</td>\n",
       "      <td>R03061</td>\n",
       "      <td>4</td>\n",
       "      <td>629</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>U06054</td>\n",
       "      <td>R00114</td>\n",
       "      <td>4</td>\n",
       "      <td>359</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>U01794</td>\n",
       "      <td>R00114</td>\n",
       "      <td>4</td>\n",
       "      <td>1129</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      resume_seq recruitment_seq  degree  text_keyword_x  education\n",
       "0         U05833          R03838       4             535          3\n",
       "1         U05260          R03838       4              42          3\n",
       "2         U04741          R03838       4             479          3\n",
       "3         U05144          R03838       4            1037          3\n",
       "4         U04622          R03838       4            1219          3\n",
       "...          ...             ...     ...             ...        ...\n",
       "57941     U00108          R03242       3             784          3\n",
       "57942     U00637          R03061       4            1234          4\n",
       "57943     U00290          R03061       4             629          4\n",
       "57944     U06054          R00114       4             359          3\n",
       "57945     U01794          R00114       4            1129          3\n",
       "\n",
       "[57946 rows x 5 columns]"
      ]
     },
     "execution_count": 311,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "interaction_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 312,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>text_keyword_x</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R03838</td>\n",
       "      <td>535</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U05260</td>\n",
       "      <td>R03838</td>\n",
       "      <td>42</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>U04741</td>\n",
       "      <td>R03838</td>\n",
       "      <td>479</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>U05144</td>\n",
       "      <td>R03838</td>\n",
       "      <td>1037</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>U04622</td>\n",
       "      <td>R03838</td>\n",
       "      <td>1219</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>U00108</td>\n",
       "      <td>R03242</td>\n",
       "      <td>784</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>U00637</td>\n",
       "      <td>R03061</td>\n",
       "      <td>1234</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>U00290</td>\n",
       "      <td>R03061</td>\n",
       "      <td>629</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>U06054</td>\n",
       "      <td>R00114</td>\n",
       "      <td>359</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>U01794</td>\n",
       "      <td>R00114</td>\n",
       "      <td>1129</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      resume_seq recruitment_seq  text_keyword_x\n",
       "0         U05833          R03838             535\n",
       "1         U05260          R03838              42\n",
       "2         U04741          R03838             479\n",
       "3         U05144          R03838            1037\n",
       "4         U04622          R03838            1219\n",
       "...          ...             ...             ...\n",
       "57941     U00108          R03242             784\n",
       "57942     U00637          R03061            1234\n",
       "57943     U00290          R03061             629\n",
       "57944     U06054          R00114             359\n",
       "57945     U01794          R00114            1129\n",
       "\n",
       "[57946 rows x 3 columns]"
      ]
     },
     "execution_count": 312,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "interaction_data = interaction_data[['resume_seq','recruitment_seq', 'text_keyword_x']]\n",
    "interaction_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 369,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "resume_seq         0\n",
       "recruitment_seq    0\n",
       "text_keyword_x     0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 369,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "interaction_data.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 315,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>recruitment_seq</th>\n",
       "      <th>education</th>\n",
       "      <th>major_task</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>R03838</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>R03838</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>R03838</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>R03838</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>R03838</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57941</th>\n",
       "      <td>R03242</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57942</th>\n",
       "      <td>R03061</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57943</th>\n",
       "      <td>R03061</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57944</th>\n",
       "      <td>R00114</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57945</th>\n",
       "      <td>R00114</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57946 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      recruitment_seq  education  major_task\n",
       "0              R03838          3           2\n",
       "1              R03838          3           2\n",
       "2              R03838          3           2\n",
       "3              R03838          3           2\n",
       "4              R03838          3           2\n",
       "...               ...        ...         ...\n",
       "57941          R03242          3           2\n",
       "57942          R03061          4           2\n",
       "57943          R03061          4           2\n",
       "57944          R00114          3           7\n",
       "57945          R00114          3           7\n",
       "\n",
       "[57946 rows x 3 columns]"
      ]
     },
     "execution_count": 315,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "item_data = train[['recruitment_seq', 'education', 'major_task']]\n",
    "item_data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 데이터 전처리"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 357,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from lightfm.data import Dataset\n",
    "from scipy.io import mmwrite\n",
    "\n",
    "item_meta = item_data\n",
    "\n",
    "\n",
    "item_features_source = [(item_meta['recruitment_seq'][i],\n",
    "                        [item_meta['education'][i],\n",
    "                         item_meta['major_task'][i]]) \n",
    "                         for i in range(item_meta.shape[0])]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 358,
   "metadata": {},
   "outputs": [],
   "source": [
    "dataset = Dataset()\n",
    "dataset.fit(users=interaction_data['resume_seq'].unique(),\n",
    "            items=interaction_data['recruitment_seq'].unique(),\n",
    "            item_features=item_meta[item_meta.columns[1:]].values.flatten(),\n",
    "            )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "flipped_dataset_user_id_mapping = {v : k for k , v in dataset._user_id_mapping.items()}\n",
    "flipped_dataset_user_id_mapping"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 435,
   "metadata": {},
   "outputs": [],
   "source": [
    "interactions, weights = dataset.build_interactions(interaction_data.iloc[:, 0:3].values)\n",
    "item_features = dataset.build_item_features(item_features_source)\n",
    "weights = weights.astype(np.int32)\n",
    "\n",
    "# Save\n",
    "mmwrite('data/interactions.mtx', interactions)\n",
    "mmwrite('data/item_features.mtx', item_features)\n",
    "mmwrite('data/weights.mtx', weights)\n",
    "\n",
    "# Split Train, Test data\n",
    "train, test = random_train_test_split(interactions, test_percentage=0.1)\n",
    "train, test = train.tocsr().tocoo(), test.tocsr().tocoo()\n",
    "train_weights = train.multiply(weights).tocoo()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'interactions' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m/home/kchh1015/proj1/test.ipynb Cell 38\u001b[0m line \u001b[0;36m1\n\u001b[0;32m----> <a href='vscode-notebook-cell://ssh-remote%2B7b22686f73744e616d65223a22474350227d/home/kchh1015/proj1/test.ipynb#Y113sdnNjb2RlLXJlbW90ZQ%3D%3D?line=0'>1</a>\u001b[0m interactions\n",
      "\u001b[0;31mNameError\u001b[0m: name 'interactions' is not defined"
     ]
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 436,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<8482x6695 sparse matrix of type '<class 'numpy.int32'>'\n",
       "\twith 57946 stored elements in COOrdinate format>"
      ]
     },
     "execution_count": 436,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weights"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 437,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<8482x6695 sparse matrix of type '<class 'numpy.int32'>'\n",
       "\twith 57946 stored elements in COOrdinate format>"
      ]
     },
     "execution_count": 437,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "interactions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 441,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<8482x6695 sparse matrix of type '<class 'numpy.int32'>'\n",
       "\twith 52151 stored elements in COOrdinate format>"
      ]
     },
     "execution_count": 441,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 442,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<8482x6695 sparse matrix of type '<class 'numpy.int32'>'\n",
       "\twith 52111 stored elements in COOrdinate format>"
      ]
     },
     "execution_count": 442,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_weights"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from scipy.sparse import coo_matrix\n",
    "\n",
    "# train_weights를 coo_matrix 형식으로 변환\n",
    "train_weights_coo = coo_matrix(train_weights)\n",
    "\n",
    "# 두 행렬의 비교를 통해 train_weights에서 0으로 만들 위치 식별\n",
    "zero_indices = set(zip(train.row, train.col)) - set(zip(train_weights.row, train_weights.col))\n",
    "\n",
    "# coo_matrix를 수정할 수 없으므로 수정 작업을 위해 csr_matrix로 변환\n",
    "train_weights_csr = train_weights_coo.tocsr()\n",
    "\n",
    "# 해당 위치의 값을 0으로 설정\n",
    "for row, col in zero_indices:\n",
    "    train_weights_csr[row, col] = 0\n",
    "\n",
    "# 최종적으로 coo_matrix 형식으로 변환된 train_weights_csr를 coo_matrix로 변환\n",
    "train_weights_final = coo_matrix(train_weights_csr)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 445,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<8482x6695 sparse matrix of type '<class 'numpy.int32'>'\n",
       "\twith 52151 stored elements in COOrdinate format>"
      ]
     },
     "execution_count": 445,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_weights_final"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 모델 학습"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 455,
   "metadata": {},
   "outputs": [],
   "source": [
    "from hyperopt import fmin, hp, tpe, Trials\n",
    "\n",
    "# Define Search Space\n",
    "trials = Trials()\n",
    "space = [hp.choice('no_components', range(10, 50, 10)),\n",
    "         hp.uniform('learning_rate', 0.01, 0.05)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 459,
   "metadata": {},
   "outputs": [],
   "source": [
    "def objective(params):\n",
    "    \n",
    "    no_components, learning_rate = params\n",
    "\n",
    "    model = LightFM(no_components=no_components,\n",
    "                    learning_schedule='adagrad',\n",
    "                    loss='warp',\n",
    "                    learning_rate=learning_rate,\n",
    "                    random_state=0)\n",
    "\n",
    "    model.fit(interactions=train,\n",
    "              item_features=item_features,\n",
    "              sample_weight=train_weights_final,\n",
    "              epochs=30,\n",
    "              verbose=False)\n",
    "    \n",
    "        \n",
    "    output = lightfm_prec_at_k(model, test, k=5, item_features=item_features).mean()\n",
    "    test_auc = auc_score(model, test, item_features=item_features).mean()\n",
    "\n",
    "    print(\"no_comp: {}, lrn_rate: {:.5f}, precision: {:.5f}, AUC: {:.5f}\".format(no_components, learning_rate, output, test_auc))\n",
    "\n",
    "    return -output, model  # Return the value to minimize"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 460,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "100%|██████████| 10/10 [00:00<?, ?trial/s, best loss=?]\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{'learning_rate': 0.029734421801096547, 'no_components': 3}"
      ]
     },
     "execution_count": 460,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "best_params = fmin(fn=objective, space=space, algo=tpe.suggest, max_evals=10, trials=trials)\n",
    "best_params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 한 유저당 5개의 이력서 추천"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "defalut_parmas = (3,0.30)\n",
    "output, trained_model = objective(defalut_parmas)\n",
    "\n",
    "def recommend_jobs_for_all_users(model, interactions, item_features, num_items=5):\n",
    "    recommended_jobs = []\n",
    "    n_users, _ = interactions.shape\n",
    "\n",
    "    for user_index in range(n_users):  # 유저의 숫자만큼 for문을 돈다. 8482번\n",
    "        scores = model.predict(user_index, np.arange(item_features.shape[0]), item_features=item_features) # 모든 사용자가 모든 항목에 대해서 선호도 점수를 매긴것\n",
    "        scores[interactions.getrow(user_index).indices] = -np.inf # 이미 지원한 회사 제외\n",
    "        top_items = interaction_data['recruitment_seq'][np.argsort(-scores)]\n",
    "        # top_items = np.argsort(-scores)[:num_items]   # 상위 5개 뽑기\n",
    "        recommended_jobs.extend([(user_index, x) for x in top_items[:5]])\n",
    "        # recommended_jobs.extend([(user_features.indices[user_index], item_features.indices[item]) for item in top_items])\n",
    "\n",
    "    df_recommended_jobs = pd.DataFrame(recommended_jobs, columns=['resume_seq', 'recruitment_seq'])\n",
    "    return df_recommended_jobs\n",
    "\n",
    "\n",
    "# objective 함수를 기반으로 모든 유저에 대한 추천 생성\n",
    "df_all_recommended_jobs = recommend_jobs_for_all_users(trained_model, train, item_features, num_items=5)\n",
    "\n",
    "# 데이터프레임 출력\n",
    "df_all_recommended_jobs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 469,
   "metadata": {},
   "outputs": [],
   "source": [
    "def recommend_jobs_for_all_users(model, interactions, item_features, num_items=5):\n",
    "    recommended_jobs = []\n",
    "    n_users, _ = interactions.shape\n",
    "\n",
    "    for user_index in range(n_users):\n",
    "        # 이미 추천한 회사 기록을 저장할 집합(set) 생성\n",
    "        recommended_set = set()\n",
    "\n",
    "        # 유저가 이미 지원한 회사 제외하고 선호도 점수 계산\n",
    "        scores = model.predict(user_index, np.arange(item_features.shape[0]), item_features=item_features)\n",
    "        scores[interactions.getrow(user_index).indices] = -np.inf\n",
    "\n",
    "        # 선호도 점수가 높은 순으로 회사 추천\n",
    "        top_items = interaction_data['recruitment_seq'][np.argsort(-scores)]\n",
    "\n",
    "        # 중복 추천을 방지하고 상위 n개의 아이템을 추천 리스트에 추가\n",
    "        for item in top_items:\n",
    "            if item not in recommended_set:\n",
    "                recommended_set.add(item)\n",
    "                recommended_jobs.append((user_index, item))\n",
    "\n",
    "                # num_items만큼 추천한 경우 반복문 종료\n",
    "                if len(recommended_set) == num_items:\n",
    "                    break\n",
    "\n",
    "    df_recommended_jobs = pd.DataFrame(recommended_jobs, columns=['resume_seq', 'recruitment_seq'])\n",
    "    return df_recommended_jobs\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 470,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>R02779</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>R01544</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>R04066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>R00550</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>R04901</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42405</th>\n",
       "      <td>8481</td>\n",
       "      <td>R04129</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42406</th>\n",
       "      <td>8481</td>\n",
       "      <td>R03027</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42407</th>\n",
       "      <td>8481</td>\n",
       "      <td>R03428</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42408</th>\n",
       "      <td>8481</td>\n",
       "      <td>R05186</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42409</th>\n",
       "      <td>8481</td>\n",
       "      <td>R00508</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>42410 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       resume_seq recruitment_seq\n",
       "0               0          R02779\n",
       "1               0          R01544\n",
       "2               0          R04066\n",
       "3               0          R00550\n",
       "4               0          R04901\n",
       "...           ...             ...\n",
       "42405        8481          R04129\n",
       "42406        8481          R03027\n",
       "42407        8481          R03428\n",
       "42408        8481          R05186\n",
       "42409        8481          R00508\n",
       "\n",
       "[42410 rows x 2 columns]"
      ]
     },
     "execution_count": 470,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# objective 함수를 기반으로 모든 유저에 대한 추천 생성\n",
    "df_all_recommended_jobs = recommend_jobs_for_all_users(trained_model, train, item_features, num_items=5)\n",
    "\n",
    "# 데이터프레임 출력\n",
    "df_all_recommended_jobs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 471,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>resume_seq</th>\n",
       "      <th>recruitment_seq</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R02779</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R01544</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R04066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R00550</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>U05833</td>\n",
       "      <td>R04901</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42405</th>\n",
       "      <td>U03563</td>\n",
       "      <td>R04129</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42406</th>\n",
       "      <td>U03563</td>\n",
       "      <td>R03027</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42407</th>\n",
       "      <td>U03563</td>\n",
       "      <td>R03428</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42408</th>\n",
       "      <td>U03563</td>\n",
       "      <td>R05186</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42409</th>\n",
       "      <td>U03563</td>\n",
       "      <td>R00508</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>42410 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      resume_seq recruitment_seq\n",
       "0         U05833          R02779\n",
       "1         U05833          R01544\n",
       "2         U05833          R04066\n",
       "3         U05833          R00550\n",
       "4         U05833          R04901\n",
       "...          ...             ...\n",
       "42405     U03563          R04129\n",
       "42406     U03563          R03027\n",
       "42407     U03563          R03428\n",
       "42408     U03563          R05186\n",
       "42409     U03563          R00508\n",
       "\n",
       "[42410 rows x 2 columns]"
      ]
     },
     "execution_count": 471,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 매핑된 값으로 데이터프레임 생성\n",
    "df_all_recommended_jobs_mapped = df_all_recommended_jobs.replace({'resume_seq': flipped_dataset_user_id_mapping})\n",
    "# 데이터프레임 출력\n",
    "df_all_recommended_jobs_mapped"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 472,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 472,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_all_recommended_jobs_mapped.duplicated().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 473,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_all_recommended_jobs_mapped.to_csv(\"submission.csv\", index = None)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "test_prj",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.18"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
